{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kuziv/Desktop/Desktop%20Folders/Client%20Projects/MVp/mvp-web-agency/lib/supabase.ts"],"sourcesContent":["// FIX: Ensure this file is never bundled to the client\r\nimport \"server-only\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\n// Supabase configuration\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\r\n\r\nif (!supabaseUrl || !supabaseServiceRoleKey) {\r\n  throw new Error(\"Missing Supabase environment variables\");\r\n}\r\n\r\n// Create Supabase client (server-side only, uses service role key)\r\n// This client has ADMIN privileges and bypasses Row Level Security (RLS)\r\nexport const supabase = createClient(supabaseUrl, supabaseServiceRoleKey, {\r\n  auth: {\r\n    autoRefreshToken: false,\r\n    persistSession: false,\r\n    detectSessionInUrl: false,\r\n  },\r\n});\r\n\r\n// Types for better TypeScript support\r\nexport type Database = {\r\n  public: {\r\n    Tables: {\r\n      leads: {\r\n        Row: {\r\n          id: string;\r\n          business_name: string;\r\n          email: string | null;\r\n          website: string | null;\r\n          phone: string | null;\r\n          industry: string;\r\n          status: string;\r\n          source: string;\r\n          scraped_data: any | null;\r\n          quality_score: number | null;\r\n          email_sent_at: string | null;\r\n          email_opened_at: string | null;\r\n          email_clicked_at: string | null;\r\n          email_replied_at: string | null;\r\n          automation_paused: string | null;\r\n          created_at: string;\r\n          updated_at: string;\r\n        };\r\n        Insert: {\r\n          id?: string;\r\n          business_name: string;\r\n          email?: string | null;\r\n          website?: string | null;\r\n          phone?: string | null;\r\n          industry: string;\r\n          status?: string;\r\n          source?: string;\r\n          scraped_data?: any | null;\r\n          quality_score?: number | null;\r\n          email_sent_at?: string | null;\r\n          email_opened_at?: string | null;\r\n          email_clicked_at?: string | null;\r\n          email_replied_at?: string | null;\r\n          automation_paused?: string | null;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n        };\r\n        Update: {\r\n          id?: string;\r\n          business_name?: string;\r\n          email?: string | null;\r\n          website?: string | null;\r\n          phone?: string | null;\r\n          industry?: string;\r\n          status?: string;\r\n          source?: string;\r\n          scraped_data?: any | null;\r\n          quality_score?: number | null;\r\n          email_sent_at?: string | null;\r\n          email_opened_at?: string | null;\r\n          email_clicked_at?: string | null;\r\n          email_replied_at?: string | null;\r\n          automation_paused?: string | null;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n        };\r\n      };\r\n    };\r\n  };\r\n};\r\n"],"names":[],"mappings":"AAAA,uDAAuD;;;;;AACvD;AACA;;;AAEA,yBAAyB;AACzB,MAAM;AACN,MAAM,yBAAyB,QAAQ,GAAG,CAAC,yBAAyB;AAEpE,IAAI,CAAC,eAAe,CAAC,wBAAwB;IAC3C,MAAM,IAAI,MAAM;AAClB;AAIO,MAAM,WAAW,IAAA,gMAAY,EAAC,aAAa,wBAAwB;IACxE,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;QAChB,oBAAoB;IACtB;AACF","debugId":null}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kuziv/Desktop/Desktop%20Folders/Client%20Projects/MVp/mvp-web-agency/app/api/admin/financials/metrics/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport { supabase } from '@/lib/supabase'\r\n\r\nexport async function GET() {\r\n  try {\r\n    // Get all active subscriptions\r\n    const { data: subscriptions } = await supabase\r\n      .from('subscriptions')\r\n      .select('amount')\r\n      .eq('status', 'active')\r\n\r\n    const totalRevenue = subscriptions?.reduce((sum, s) =>\r\n      sum + parseFloat(s.amount || '0'), 0\r\n    ) || 0\r\n\r\n    // For MVP, expenses are estimated\r\n    // In production, you'd sum from expenses table\r\n    const totalExpenses = 0 // TODO: Sum from expenses table when tracking\r\n\r\n    const grossProfit = totalRevenue - totalExpenses\r\n    const grossMarginPercent = totalRevenue > 0\r\n      ? Math.round((grossProfit / totalRevenue) * 100)\r\n      : 0\r\n\r\n    const totalCustomers = subscriptions?.length || 0\r\n    const avgLTV = 1188 // $99/month Ã— 12 months\r\n    const avgCAC = 0.70 // From lead gen costs\r\n    const ltvCacRatio = avgCAC > 0\r\n      ? Math.round((avgLTV / avgCAC) * 10) / 10\r\n      : 0\r\n    const paybackMonths = avgCAC > 0 && totalRevenue > 0\r\n      ? Math.round((avgCAC / (totalRevenue / totalCustomers)) * 10) / 10\r\n      : 0\r\n\r\n    return NextResponse.json({\r\n      stats: {\r\n        totalRevenue: Math.round(totalRevenue * 100) / 100,\r\n        totalExpenses: Math.round(totalExpenses * 100) / 100,\r\n        grossProfit: Math.round(grossProfit * 100) / 100,\r\n        grossMarginPercent,\r\n        totalCustomers,\r\n        profitableCustomers: totalCustomers, // All profitable at MVP stage\r\n        unprofitableCustomers: 0,\r\n        avgLTV: Math.round(avgLTV * 100) / 100,\r\n        avgCAC: Math.round(avgCAC * 100) / 100,\r\n        ltvCacRatio,\r\n        paybackMonths,\r\n      },\r\n    })\r\n  } catch (error) {\r\n    console.error('Financials error:', error)\r\n    return NextResponse.json({ stats: {} }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe;IACpB,IAAI;QACF,+BAA+B;QAC/B,MAAM,EAAE,MAAM,aAAa,EAAE,GAAG,MAAM,6HAAQ,CAC3C,IAAI,CAAC,iBACL,MAAM,CAAC,UACP,EAAE,CAAC,UAAU;QAEhB,MAAM,eAAe,eAAe,OAAO,CAAC,KAAK,IAC/C,MAAM,WAAW,EAAE,MAAM,IAAI,MAAM,MAChC;QAEL,kCAAkC;QAClC,+CAA+C;QAC/C,MAAM,gBAAgB,EAAE,8CAA8C;;QAEtE,MAAM,cAAc,eAAe;QACnC,MAAM,qBAAqB,eAAe,IACtC,KAAK,KAAK,CAAC,AAAC,cAAc,eAAgB,OAC1C;QAEJ,MAAM,iBAAiB,eAAe,UAAU;QAChD,MAAM,SAAS,KAAK,wBAAwB;;QAC5C,MAAM,SAAS,KAAK,sBAAsB;;QAC1C,MAAM,cAAc,SAAS,IACzB,KAAK,KAAK,CAAC,AAAC,SAAS,SAAU,MAAM,KACrC;QACJ,MAAM,gBAAgB,SAAS,KAAK,eAAe,IAC/C,KAAK,KAAK,CAAC,AAAC,SAAS,CAAC,eAAe,cAAc,IAAK,MAAM,KAC9D;QAEJ,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,OAAO;gBACL,cAAc,KAAK,KAAK,CAAC,eAAe,OAAO;gBAC/C,eAAe,KAAK,KAAK,CAAC,gBAAgB,OAAO;gBACjD,aAAa,KAAK,KAAK,CAAC,cAAc,OAAO;gBAC7C;gBACA;gBACA,qBAAqB;gBACrB,uBAAuB;gBACvB,QAAQ,KAAK,KAAK,CAAC,SAAS,OAAO;gBACnC,QAAQ,KAAK,KAAK,CAAC,SAAS,OAAO;gBACnC;gBACA;YACF;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,CAAC;QAAE,GAAG;YAAE,QAAQ;QAAI;IACxD;AACF","debugId":null}}]
}