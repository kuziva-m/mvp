{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kuziv/Desktop/Desktop%20Folders/Client%20Projects/MVp/mvp-web-agency/lib/supabase.ts"],"sourcesContent":["// FIX: Ensure this file is never bundled to the client\r\nimport \"server-only\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\n// Supabase configuration\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\r\n\r\nif (!supabaseUrl || !supabaseServiceRoleKey) {\r\n  throw new Error(\"Missing Supabase environment variables\");\r\n}\r\n\r\n// Create Supabase client (server-side only, uses service role key)\r\n// This client has ADMIN privileges and bypasses Row Level Security (RLS)\r\nexport const supabase = createClient(supabaseUrl, supabaseServiceRoleKey, {\r\n  auth: {\r\n    autoRefreshToken: false,\r\n    persistSession: false,\r\n    detectSessionInUrl: false,\r\n  },\r\n});\r\n\r\n// Types for better TypeScript support\r\nexport type Database = {\r\n  public: {\r\n    Tables: {\r\n      leads: {\r\n        Row: {\r\n          id: string;\r\n          business_name: string;\r\n          email: string | null;\r\n          website: string | null;\r\n          phone: string | null;\r\n          industry: string;\r\n          status: string;\r\n          source: string;\r\n          scraped_data: any | null;\r\n          quality_score: number | null;\r\n          email_sent_at: string | null;\r\n          email_opened_at: string | null;\r\n          email_clicked_at: string | null;\r\n          email_replied_at: string | null;\r\n          automation_paused: string | null;\r\n          created_at: string;\r\n          updated_at: string;\r\n        };\r\n        Insert: {\r\n          id?: string;\r\n          business_name: string;\r\n          email?: string | null;\r\n          website?: string | null;\r\n          phone?: string | null;\r\n          industry: string;\r\n          status?: string;\r\n          source?: string;\r\n          scraped_data?: any | null;\r\n          quality_score?: number | null;\r\n          email_sent_at?: string | null;\r\n          email_opened_at?: string | null;\r\n          email_clicked_at?: string | null;\r\n          email_replied_at?: string | null;\r\n          automation_paused?: string | null;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n        };\r\n        Update: {\r\n          id?: string;\r\n          business_name?: string;\r\n          email?: string | null;\r\n          website?: string | null;\r\n          phone?: string | null;\r\n          industry?: string;\r\n          status?: string;\r\n          source?: string;\r\n          scraped_data?: any | null;\r\n          quality_score?: number | null;\r\n          email_sent_at?: string | null;\r\n          email_opened_at?: string | null;\r\n          email_clicked_at?: string | null;\r\n          email_replied_at?: string | null;\r\n          automation_paused?: string | null;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n        };\r\n      };\r\n    };\r\n  };\r\n};\r\n"],"names":[],"mappings":"AAAA,uDAAuD;;;;;AACvD;AACA;;;AAEA,yBAAyB;AACzB,MAAM;AACN,MAAM,yBAAyB,QAAQ,GAAG,CAAC,yBAAyB;AAEpE,IAAI,CAAC,eAAe,CAAC,wBAAwB;IAC3C,MAAM,IAAI,MAAM;AAClB;AAIO,MAAM,WAAW,IAAA,yLAAY,EAAC,aAAa,wBAAwB;IACxE,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;QAChB,oBAAoB;IACtB;AACF"}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kuziv/Desktop/Desktop%20Folders/Client%20Projects/MVp/mvp-web-agency/app/api/admin/lead-stats/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport { supabase } from '@/lib/supabase'\r\n\r\nexport async function GET() {\r\n  try {\r\n    const today = new Date().toISOString().split('T')[0]\r\n\r\n    const { data: todayLeads } = await supabase\r\n      .from('leads')\r\n      .select('id, source, quality_score')\r\n      .gte('created_at', today)\r\n\r\n    const { data: duplicates } = await supabase\r\n      .from('duplicate_logs')\r\n      .select('id', { count: 'exact' })\r\n      .gte('logged_at', today)\r\n\r\n    const byClay = todayLeads?.filter(l => l.source.includes('clay')).length || 0\r\n    const byScrapeMaps = todayLeads?.filter(l => l.source.includes('scrapemaps')).length || 0\r\n    const byMock = todayLeads?.filter(l => l.source === 'mock').length || 0\r\n\r\n    const avgScore = todayLeads && todayLeads.length > 0\r\n      ? todayLeads.reduce((sum, l) => sum + (l.quality_score || 0), 0) / todayLeads.length\r\n      : 0\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      mode: process.env.CLAY_WEBHOOK_SECRET ? 'PRODUCTION' : 'MOCK',\r\n      stats: {\r\n        today: {\r\n          total: todayLeads?.length || 0,\r\n          clay: byClay,\r\n          scrapemaps: byScrapeMaps,\r\n          mock: byMock,\r\n          duplicates: (duplicates as any)?.count || 0,\r\n          avgQualityScore: Math.round(avgScore),\r\n        },\r\n      },\r\n    })\r\n  } catch (error) {\r\n    return NextResponse.json({ error: 'Failed' }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;QAEpD,MAAM,EAAE,MAAM,UAAU,EAAE,GAAG,MAAM,6HAAQ,CACxC,IAAI,CAAC,SACL,MAAM,CAAC,6BACP,GAAG,CAAC,cAAc;QAErB,MAAM,EAAE,MAAM,UAAU,EAAE,GAAG,MAAM,6HAAQ,CACxC,IAAI,CAAC,kBACL,MAAM,CAAC,MAAM;YAAE,OAAO;QAAQ,GAC9B,GAAG,CAAC,aAAa;QAEpB,MAAM,SAAS,YAAY,OAAO,CAAA,IAAK,EAAE,MAAM,CAAC,QAAQ,CAAC,SAAS,UAAU;QAC5E,MAAM,eAAe,YAAY,OAAO,CAAA,IAAK,EAAE,MAAM,CAAC,QAAQ,CAAC,eAAe,UAAU;QACxF,MAAM,SAAS,YAAY,OAAO,CAAA,IAAK,EAAE,MAAM,KAAK,QAAQ,UAAU;QAEtE,MAAM,WAAW,cAAc,WAAW,MAAM,GAAG,IAC/C,WAAW,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,CAAC,EAAE,aAAa,IAAI,CAAC,GAAG,KAAK,WAAW,MAAM,GAClF;QAEJ,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM,QAAQ,GAAG,CAAC,mBAAmB,GAAG,eAAe;YACvD,OAAO;gBACL,OAAO;oBACL,OAAO,YAAY,UAAU;oBAC7B,MAAM;oBACN,YAAY;oBACZ,MAAM;oBACN,YAAY,AAAC,YAAoB,SAAS;oBAC1C,iBAAiB,KAAK,KAAK,CAAC;gBAC9B;YACF;QACF;IACF,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAS,GAAG;YAAE,QAAQ;QAAI;IAC9D;AACF"}}]
}