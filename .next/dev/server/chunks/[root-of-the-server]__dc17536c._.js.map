{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kuziv/Desktop/Desktop%20Folders/Client%20Projects/MVp/mvp-web-agency/lib/supabase.ts"],"sourcesContent":["// FIX: Ensure this file is never bundled to the client\r\nimport \"server-only\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\n// Supabase configuration\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\r\n\r\nif (!supabaseUrl || !supabaseServiceRoleKey) {\r\n  throw new Error(\"Missing Supabase environment variables\");\r\n}\r\n\r\n// Create Supabase client (server-side only, uses service role key)\r\n// This client has ADMIN privileges and bypasses Row Level Security (RLS)\r\nexport const supabase = createClient(supabaseUrl, supabaseServiceRoleKey, {\r\n  auth: {\r\n    autoRefreshToken: false,\r\n    persistSession: false,\r\n    detectSessionInUrl: false,\r\n  },\r\n});\r\n\r\n// Types for better TypeScript support\r\nexport type Database = {\r\n  public: {\r\n    Tables: {\r\n      leads: {\r\n        Row: {\r\n          id: string;\r\n          business_name: string;\r\n          email: string | null;\r\n          website: string | null;\r\n          phone: string | null;\r\n          industry: string;\r\n          status: string;\r\n          source: string;\r\n          scraped_data: any | null;\r\n          quality_score: number | null;\r\n          email_sent_at: string | null;\r\n          email_opened_at: string | null;\r\n          email_clicked_at: string | null;\r\n          email_replied_at: string | null;\r\n          automation_paused: string | null;\r\n          created_at: string;\r\n          updated_at: string;\r\n        };\r\n        Insert: {\r\n          id?: string;\r\n          business_name: string;\r\n          email?: string | null;\r\n          website?: string | null;\r\n          phone?: string | null;\r\n          industry: string;\r\n          status?: string;\r\n          source?: string;\r\n          scraped_data?: any | null;\r\n          quality_score?: number | null;\r\n          email_sent_at?: string | null;\r\n          email_opened_at?: string | null;\r\n          email_clicked_at?: string | null;\r\n          email_replied_at?: string | null;\r\n          automation_paused?: string | null;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n        };\r\n        Update: {\r\n          id?: string;\r\n          business_name?: string;\r\n          email?: string | null;\r\n          website?: string | null;\r\n          phone?: string | null;\r\n          industry?: string;\r\n          status?: string;\r\n          source?: string;\r\n          scraped_data?: any | null;\r\n          quality_score?: number | null;\r\n          email_sent_at?: string | null;\r\n          email_opened_at?: string | null;\r\n          email_clicked_at?: string | null;\r\n          email_replied_at?: string | null;\r\n          automation_paused?: string | null;\r\n          created_at?: string;\r\n          updated_at?: string;\r\n        };\r\n      };\r\n    };\r\n  };\r\n};\r\n"],"names":[],"mappings":"AAAA,uDAAuD;;;;;AACvD;AACA;;;AAEA,yBAAyB;AACzB,MAAM;AACN,MAAM,yBAAyB,QAAQ,GAAG,CAAC,yBAAyB;AAEpE,IAAI,CAAC,eAAe,CAAC,wBAAwB;IAC3C,MAAM,IAAI,MAAM;AAClB;AAIO,MAAM,WAAW,IAAA,yLAAY,EAAC,aAAa,wBAAwB;IACxE,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;QAChB,oBAAoB;IACtB;AACF"}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kuziv/Desktop/Desktop%20Folders/Client%20Projects/MVp/mvp-web-agency/app/api/admin/lead-magnet/submissions/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { supabase } from '@/lib/supabase'\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const searchParams = request.nextUrl.searchParams\r\n    const status = searchParams.get('status')\r\n    const campaign = searchParams.get('campaign')\r\n\r\n    let query = supabase\r\n      .from('lead_magnet_submissions')\r\n      .select('*')\r\n      .order('created_at', { ascending: false })\r\n\r\n    // Filter by status if provided\r\n    if (status && status !== 'all') {\r\n      query = query.eq('status', status)\r\n    }\r\n\r\n    // Filter by campaign if provided\r\n    if (campaign) {\r\n      query = query.eq('campaign_id', campaign)\r\n    }\r\n\r\n    const { data: submissions, error } = await query\r\n\r\n    if (error) {\r\n      throw error\r\n    }\r\n\r\n    // Fetch related data for each submission\r\n    const enrichedSubmissions = await Promise.all(\r\n      (submissions || []).map(async (submission) => {\r\n        let campaign = null\r\n        let lead = null\r\n        let site = null\r\n\r\n        if (submission.campaign_id) {\r\n          const { data } = await supabase\r\n            .from('lead_magnet_campaigns')\r\n            .select('id, name, platform')\r\n            .eq('id', submission.campaign_id)\r\n            .single()\r\n          campaign = data\r\n        }\r\n\r\n        if (submission.lead_id) {\r\n          const { data } = await supabase\r\n            .from('leads')\r\n            .select('id, business_name, email, industry, status')\r\n            .eq('id', submission.lead_id)\r\n            .single()\r\n          lead = data\r\n        }\r\n\r\n        if (submission.site_id) {\r\n          const { data } = await supabase\r\n            .from('sites')\r\n            .select('id, subdomain, status')\r\n            .eq('id', submission.site_id)\r\n            .single()\r\n          site = data\r\n        }\r\n\r\n        return {\r\n          ...submission,\r\n          campaign,\r\n          lead,\r\n          site,\r\n        }\r\n      })\r\n    )\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      submissions: enrichedSubmissions,\r\n      total: enrichedSubmissions.length,\r\n    })\r\n\r\n  } catch (error) {\r\n    console.error('‚ùå Failed to get submissions:', error)\r\n    return NextResponse.json(\r\n      { success: false, error: 'Failed to get submissions' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;QACjD,MAAM,SAAS,aAAa,GAAG,CAAC;QAChC,MAAM,WAAW,aAAa,GAAG,CAAC;QAElC,IAAI,QAAQ,6HAAQ,CACjB,IAAI,CAAC,2BACL,MAAM,CAAC,KACP,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE1C,+BAA+B;QAC/B,IAAI,UAAU,WAAW,OAAO;YAC9B,QAAQ,MAAM,EAAE,CAAC,UAAU;QAC7B;QAEA,iCAAiC;QACjC,IAAI,UAAU;YACZ,QAAQ,MAAM,EAAE,CAAC,eAAe;QAClC;QAEA,MAAM,EAAE,MAAM,WAAW,EAAE,KAAK,EAAE,GAAG,MAAM;QAE3C,IAAI,OAAO;YACT,MAAM;QACR;QAEA,yCAAyC;QACzC,MAAM,sBAAsB,MAAM,QAAQ,GAAG,CAC3C,CAAC,eAAe,EAAE,EAAE,GAAG,CAAC,OAAO;YAC7B,IAAI,WAAW;YACf,IAAI,OAAO;YACX,IAAI,OAAO;YAEX,IAAI,WAAW,WAAW,EAAE;gBAC1B,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,6HAAQ,CAC5B,IAAI,CAAC,yBACL,MAAM,CAAC,sBACP,EAAE,CAAC,MAAM,WAAW,WAAW,EAC/B,MAAM;gBACT,WAAW;YACb;YAEA,IAAI,WAAW,OAAO,EAAE;gBACtB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,6HAAQ,CAC5B,IAAI,CAAC,SACL,MAAM,CAAC,8CACP,EAAE,CAAC,MAAM,WAAW,OAAO,EAC3B,MAAM;gBACT,OAAO;YACT;YAEA,IAAI,WAAW,OAAO,EAAE;gBACtB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,6HAAQ,CAC5B,IAAI,CAAC,SACL,MAAM,CAAC,yBACP,EAAE,CAAC,MAAM,WAAW,OAAO,EAC3B,MAAM;gBACT,OAAO;YACT;YAEA,OAAO;gBACL,GAAG,UAAU;gBACb;gBACA;gBACA;YACF;QACF;QAGF,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,aAAa;YACb,OAAO,oBAAoB,MAAM;QACnC;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO;QAA4B,GACrD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}